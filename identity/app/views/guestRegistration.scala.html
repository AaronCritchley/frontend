@(page: model.MetaData with tracking.TrackingParams, idRequest: services.IdentityRequest, idUrlBuilder: services.IdentityUrlBuilder, registrationForm: Form[(String, String, String)])(implicit request: RequestHeader)

@import form.IdFormHelpers._
@import views.html.fragments.form.{inputField, checkbox}
@import views.html.fragments.registrationError
@import views.html.fragments.registrationFooter
@import views.html.fragments.socialSignin
@import views.html.fragments.identityPageHeader

@identityMain(page, conf.Switches.all){
}{
    <div class="identity-wrapper monocolumn-wrapper">
        @identityPageHeader("Complete your registration") { }

        <form class="form js-register-form" novalidate action="@idUrlBuilder.buildUrl("/register", idRequest)" role="main" method="post">
            @if(registrationForm.globalError.isDefined) {
                <div class="form__error">@registrationForm.globalErrors.map(_.message).mkString(", ")</div>
            }

            <fieldset class="fieldset">
                <div class="fieldset__heading">
                    <div class="form__note">All fields required.</div>
                </div>
                <div class="fieldset__fields">
                    <ul class="u-unstyled">

                        <input type="hidden" name="@registrationForm("user.firstName").name" value="@registrationForm("user.firstName").value" />
                        <input type="hidden" name="@registrationForm("user.secondName").name" value="@registrationForm("user.secondName").value" />
                        <input type="hidden" name="@registrationForm("user.primaryEmailAddress").name" value="@registrationForm("user.primaryEmailAddress").value" />

                        @inputField(Username(registrationForm("user.publicFields.username"), ('_label, "Username"),
                            ('_help, "Between 6 and 20 characters, letters and numbers only"), ('tabindex, 2),
                            (Symbol("data-test-id"), "reg-username")))

                        @inputField(Password(registrationForm("user.password"), ('_label, "Password"),
                            ('_help, "Between 6 and 20 characters"), ('class, "js-register-password js-password-strength"),
                            ('tabindex, 3), ('maxlength, 20), (Symbol("data-test-id"), "reg-pwd")))

                        <li class="form-field form-field--no-margin">
                            <label class="check-label" for="@registrationForm("receive_gnm_marketing").id">
                                @checkbox(registrationForm("receive_gnm_marketing"), ('tabindex, 4), ('checked, "checked"))
                                Keep me up to date with offers and developments from the Guardian
                            </label>
                        </li>
                        <li class="form-field">
                            <label class="check-label" for="@registrationForm("receive_third_party_marketing").id">
                                @checkbox(registrationForm("receive_third_party_marketing"), ('tabindex, 5))
                                Send me messages from 3rd party organisations screened by the Guardian
                            </label>
                        </li>
                        <li class="form-field form-field__submit">
                            <div class="form-field__note">
                                By proceeding, you agree to the Guardian's <a href="http://www.theguardian.com/help/terms-of-service" data-link-name="Terms of service">Terms of Service</a> and <a href="http://www.theguardian.com/help/privacy-policy" data-link-name="Privacy policy">Privacy Policy</a>.
                            </div>
                            <button type="submit" class="submit-input" data-link-name="Create account" tabindex="6" data-test-id="create-user-button">Create account</button>
                        </li>
                    </ul>
                </div>
            </fieldset>
        </form>
    </div>
}
